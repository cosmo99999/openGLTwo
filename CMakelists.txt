cmake_minimum_required(VERSION 3.20)
project(glfw_app LANGUAGES C CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ---- OpenGL (system) ----
find_package(OpenGL REQUIRED)

# ---- GLFW (vendored) ----
set(GLFW_BUILD_EXAMPLES OFF CACHE BOOL "" FORCE)
set(GLFW_BUILD_TESTS    OFF CACHE BOOL "" FORCE)
set(GLFW_BUILD_DOCS     OFF CACHE BOOL "" FORCE)
set(GLFW_INSTALL        OFF CACHE BOOL "" FORCE)
add_subdirectory(third_party/glfw)

# ---- GLAD (vendored generated loader) ----
add_library(glad STATIC
  third_party/glad/src/glad.c
)
target_include_directories(glad PUBLIC
  ${CMAKE_CURRENT_SOURCE_DIR}/third_party/glad/include
)

# ---- GLM (vendored) ----
add_subdirectory(third_party/glm)

# ---- App ----
add_executable(glfw_app
  src/main.cpp
  third_party/stb_image.cpp      # <- your file that has STB_IMAGE_IMPLEMENTATION
)

target_include_directories(glfw_app PRIVATE
  ${CMAKE_CURRENT_SOURCE_DIR}/third_party  # <- so #include "stb_image.h" works
)

target_link_libraries(glfw_app PRIVATE
  glfw
  glad
  OpenGL::GL
  glm::glm
)

# Linux needs these sometimes
if(UNIX AND NOT APPLE)
  target_link_libraries(glfw_app PRIVATE dl pthread)
endif()